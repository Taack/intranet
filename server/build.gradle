import java.nio.file.Files
import java.nio.file.Paths

plugins {
    id 'taack-grails-webapp.java-conventions'
}

application {
    mainClass.set("taack.website.Application")
}

bootRun {
    ignoreExitValue true
    jvmArgs(
            '-Dspring.output.ansi.enabled=always',
            '-noverify',
            '-XX:TieredStopAtLevel=1',
            '-Xmx1024m')
    sourceResources sourceSets.main
    String springProfilesActive = 'spring.profiles.active'
    systemProperty springProfilesActive, System.getProperty(springProfilesActive)
}

grails {
    def hasPlm = Files.exists(Paths.get(parent.rootDir.path, 'app', 'plm'))
    println "hasPlm: ${hasPlm}"
    exploded = true
    plugins {
        implementation project(':crew')
        if (hasPlm) implementation project(':plm')
    }
}
